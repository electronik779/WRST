# WRST - ВОДНОЭНЕРГЕТИЧЕСКИЕ РАСЧЕТЫ СЕЗОННОГО РЕГУЛИРОВАНИЯ СТОКА ПО ДИСПЕТЧЕРСКОМУ РЕЖИМУ
**Оригинальный алгоритм разработан проф. д.т.н. Г.И. Кривченко и проф. д.т.н. О.А. Муравьевым, НИУ МГСУ (бывший МИСИ)**

>[!NOTE]
>В программу алгоритм перенесен с минимальными изменениями - "спагети" код "распутан" для лучшей читаемости.

----
Программа предназначена для выработки у студентов навыка построения противоперебойной линии диспетчерского графика при сезонном регулировании стока.
Программа обеспечивает выполнение расчетов на основе решения уравнения водного баланса для сезонного (годичного) регулирования. Цикл сработки и наполнения полезного объема водохранилища равен одному году. 

Программа WRST осуществляет расчеты для заданного диспетчерского графика. Поскольку оптимальный вид диспетчерского графика для данных условий заранее неизвестен, то расчеты приходится повторять по нескольку раз: для предварительно принимаемого диспетчерского графика и после его коррекции. Последовательная коррекция диспетчерского графика для каждого календарного месяца требует выполнения как минимум 12-ти расчетов.

----

# Описание интерфейса ввода
Окно ввода исходных данных содержит три управляющие кнопки и шесть вкладок.

## Кнопки
![image](https://github.com/user-attachments/assets/352a83bf-d771-4548-b32d-87278daa6ece) - Сохранить исходные данные.

![image](https://github.com/user-attachments/assets/c9b616f5-1f21-46b2-bdd5-4fca7b6118bf) - Загрузить исходные данные.

![image](https://github.com/user-attachments/assets/b85b93a9-2972-4e26-b51d-4b4e07ccda0f) - Выполнить расчет.

>[!NOTE]
>Исходные данные сохраняются в формате CSV, разделитель - точка с запятой.

## Вкладка "Общие данные"
![image](https://github.com/user-attachments/assets/b0c43db3-315b-4815-9605-f4383a0d125f)

**`Календарный месяц, с которого начинается расчетный ряд`** - Порядковый номер месяца, с которого начинается расчет.

>[!IMPORTANT]
>Расчет должен начинаться с полностью заполненного водохранилища.

**`Схема питания ГЭС`** - Индивидуальная или групповая схема питания ГЭС.

Индивидуальная схема питания применяется с русловыми и приплотинными ГЭС, когда вода к турбине подводится индивидуальными водоводами.\
Групповая - с деривационными, когда вода к турбине подводится водоводами с развилкой.\
От схемы питания зависит способ учета потерь напора.

**`Полезный объем водохранилища, млн.м³`** - Полезный объем водохранилища в млн.м³.

**`Мертвый объем водохранилища, млн.м³`** - Мертвый объем водохранилища в млн.м³.

**`Гарантированный зарегулированный расход, м³/с`** - Гарантированный расход ГЭС.

Определяется по гарантированной мощности и минимальному напору декабря:

$$Q_{гар}=\frac{N_{гар}}{9,81 H_{т}^{дек} \eta_т \eta_г},\quad \mathnormal{м³/с},$$

где $N_{гар}$ - гарантированная мощность, кВт; $H_{т}^{дек}$ - минимальный напор декабря, м; $\eta_т$ - кпд турбины; $\eta_г$ - кпд генератора.

**`Полный (максимальный) расход ГЭС, м³/с`** - Максимальный расход турбин ГЭС.

**`Потери напора, м`** - Потери напора в водоводах при расчетном расходе в м.

**`Коэффициент потерь при Qгэс²`** - Коэффициент потерь $k$ при $Q^2$.
>[!NOTE]
>$H_W=kQ^2$

>[!IMPORTANT]
>`Потери напора, м` - отображается при выборе индивидуальной схемы питания;\
>`Коэффициент потерь при Qгэс²` - отображается при выборе групповой схемы питания.

**`Кпд агрегата`** - Средневзвешенный кпд агрегата.

## Вкладка "Приток"
![image](https://github.com/user-attachments/assets/d7de0d52-9004-44fa-bf17-aff9c6ca181a)

**На вкладке вводятся значения среднемесячного бытового стока (притока).**

Для ввода значений необходимо создать таблицу.\
Введите в поле **`Количество значений среднемесячного притока`** количество значений стока и нажмите кнопку `Создать таблицу`. Будет создана таблица, в которую необходимо ввести значения бытового стока.

>[!IMPORTANT]
>Необходимо вводить значения стока начиная с месяца, указанного в поле **`Календарный месяц, с которого начинается расчетный ряд`** на вкладке **Общие данные**.
>Длина ряда данных должна быть кратно 12 месяцам (т.е. количество данных может быть 12, 24, 36 и т.д.). 

## Вкладка "Параметры вдхр."
![image](https://github.com/user-attachments/assets/b1865b96-5cad-41bc-9296-18766c019b84)

**На вкладке вводятся значения батиграфической кривой водохранилища.**

Для ввода значений необходимо создать таблицу.\
Введите в поле **`Количество узловых точек кривой объемов водохранилища`** количество точек апроксимации кривой и нажмите кнопку `Создать таблицу`. Будет создана таблица, в которую необходимо ввести значения объемов в зависимости от отметки в водохранилище.

>[!IMPORTANT]
>- Рекомендуется задавать не менее пяти точек аппроксимации.
>- Значения объемов необходимо вводить в возрастающем порядке.
>- Т.к. кривая аппроксимируется линейной интерполяцией, то на криволинейных участках нужно выбирать больше точек.
>- Зависимость нужно начинать от дна водохранилища.

## Вкладка "Параметры НБ"
![image](https://github.com/user-attachments/assets/f97f3a2b-6687-4f49-a68f-c9aca73f3edb)

**На вкладке вводятся значения отметок нижнего бьефа в зависимости от расхода, поступающего в него.**

Для ввода значений необходимо создать таблицу.\
Введите в поле **`Количество узловых точек кривой отметок нижнего бьефа`** количество точек апроксимации кривой и нажмите кнопку `Создать таблицу`. Будет создана таблица, в которую необходимо ввести значения отметок нижнего бьефа в зависимости от от расхода, поступающего в него.

>[!IMPORTANT]
>- Рекомендуется задавать не менее пяти точек аппроксимации.
>- Значения расходов необходимо вводить в возрастающем порядке.
>- Т.к. кривая аппроксимируется линейной интерполяцией, то на криволинейных участках нужно выбирать больше точек.

## Вкладка "Диспетчерские остатки"
![image](https://github.com/user-attachments/assets/1d876323-cca3-4f22-a219-03b9c01ef822)

**На вкладке вводятся значения диспетчерских остатков на конец каждого месяца.**

>[!NOTE]
>Реализуется цикличное регулирование в течении года.

>[!TIP]
> К началу паводка водохранилище должно быть сработано до УМО.

## Вкладка "Отбор из вдхр."
![image](https://github.com/user-attachments/assets/aa44da14-88f2-4ea1-b5b8-49a4e0802b0b)

**На вкладке вводятся значения среднемесячных отборов из водохранилища.**

>[!NOTE]
>В первом приближении можно задать равными нулю.

>[!TIP]
>В отборы, кроме самих отборов, нужно включать потери на фильтрацию, испарение, льдообразование.

----

# Отображение результатов расчета

Результаты расчета выводятся в отдельном окне, которое содержит одну кнопку и три вкладки

## Кнопка
![image](https://github.com/user-attachments/assets/352a83bf-d771-4548-b32d-87278daa6ece) - Сохранить результат расчета.

>[!NOTE]
>Результаты расчета сохраняются в формате CSV, разделитель - точка с запятой.
>Результаты сохраняются в табличном виде.

## Вкладка "Таблицы"
![image](https://github.com/user-attachments/assets/6f19cf04-eb6a-4fd4-8fa6-77d9890cb432)

На вкладке располагается две таблицы.

В первой таблице приводятся следующие данные:
- Порядковый номер месяца;
- Календарный номер месяца;
- Расход притока;
- Расход ГЭС;
- Расход холостого сброса;
- Отметка верхнего бьефа;
- Отметка нижнего бьефа;
- Напор турбин;
- Мощность ГЭС;
- Величина избыточного объема.

Во второй - обеспеченности:
- Бытового стока;
- Расхода ГЭС;
- Напора ГЭС;
- Среднесуточных мощностей.

>[!NOTE]
>Расходы ГЭС, меньше гарантированного даются на фоне цвета "Коралл".
>Отрицательные расходы ГЭС даются на фоне цвета "Красный".

## Вкладка "Графики"
![image](https://github.com/user-attachments/assets/6533e711-f050-4e50-bded-39fa95b4ebcc)

На вкладке приведены две группы графиков, построенные по данным вкладки "Таблицы":

- Графики изменения во времени:
  - График 1:
    - Расход притока;
    - Расход ГЭС;
    - Расход холостого сброса;
  - График 2: 
    - Отметка верхнего бьефа;
  - График 3: 
    - Отметка нижнего бьефа;
  - График 4:  
    - Напор турбин;
  - График 5:
    - Мощность ГЭС.
      
- Графики обеспеченности параметров:
  - График 1 - обеспеченность притока к ГЭС;
  - График 2 - обеспеченность расходов ГЭС;
  - График 3 - обеспеченность напоров ГЭС;
  - График 4 - обеспеченность мощностей ГЭС.

## Вкладка "Диспетчерские графики"
![image](https://github.com/user-attachments/assets/f284d87e-3a32-411d-bfa3-3ff1c9ccb8ad)

На вкладке даны таблица и график.

На них приведены значения остаточных объемов заданных пользователем и полученных расчетом.

----
# Пример

Имеем следующие данные по бытовому стоку (притоку):

|Год \ Месяц| 1| 2| 3| 4 | 5 | 6 | 7 | 8 | 9 | 10|11|12|
|-----------|--|--|--|---|---|---|---|---|---|---|--|--|
|     1     |24|30|36|133|576|307|250|130| 73| 65|43|31|
|     2     |20|20|31|163|382|199|134| 85| 55|136|50|22|
|     3     |34|38|60|179|426|295|259|228|106| 50|67|38|

Средний многолетний расход равен ~133 м³/с. Значит паводок длится с 4-ого по 7-ой - 8-ой месяцы.

В седьмом месяце водохранилище точно будет заполнено, значит **`Календарный месяц, с которого начинается расчетный ряд`** принимаем 7-ой месяц.

Полезный объем водохранилища 710 млн.м³. В период паводка водохранилище будет полным - диспетчерские остатки равны полезному объему, т.е. принимаем диспетчерские остатки с 4-го по 7-ой месяц равными 710.

К началу паводка водохранилище должно быть пустым, т.е. диспетчерские остатки д.б. равными нулю, следовательно принимаем на конец 3-го месяца диспетчерский остаток 0.

С 8-го по 2-ой месяц $\pm$ линейно уменьшаем диспетчерские остатки, в итоге получив следующие значения:

|   Месяц    | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12|
|------------|---|---|---|---|---|---|---|---|---|---|---|---|
|Дисп.остаток|110| 10| 0 |710|710|710|710|610|510|410|310|210|

Наполняем программу данными и выполняем расчет. Результат:

![image](https://github.com/user-attachments/assets/c30654d3-6188-43e4-804f-349306cbd730)

Как видно, в месяцах с порядковыми номерами 6-10, 19-22, 31-34 расходы ГЭС меньше гарантированного 80 м³/с.

Т.к. в 4-ом месяце расходы отрицательные, а в 3-ем месяце у нас водохранилище пустое, то стоит сдвинуть диспетчерские остатки вправо, чтобы водохранилище опорожнялось к концу 4-го месяца:

|   Месяц    | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12|
|------------|---|---|---|---|---|---|---|---|---|---|---|---|
|Дисп.остаток|210|110| 10| 0 |710|710|710|710|610|510|410|310|

![image](https://github.com/user-attachments/assets/4421e003-b57e-4db7-8490-a238a9ea064f)

Остались месяцы 6-9, 18-20, 31-33.

Первый по порядку, с расходами меньше гарантированного 12-ый месяц. Из месяцев 12 (№ п.п. 6, 18 и 30) выбираем наименьший расход ГЭС - 68 м³/с. Находим дефицит расхода $80-68=12$ м³/с. Дефицит объема $12\cdot2,63=31,56\approx31,6$ млн.м³. На это значение уменьшаем диспетчерский остаток в 12-ом месяце и получаем:

|   Месяц    | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11|  12 |
|------------|---|---|---|---|---|---|---|---|---|---|---|-----|
|Дисп.остаток|210|110| 10| 0 |710|710|710|710|610|510|410|278,4|

![image](https://github.com/user-attachments/assets/6ba8b16a-1e84-46f3-9ff6-6f539b3daf25)

Остались месяцы 7-9, 19-20, 31-33.

Следующий, после исправленного 12-го - 1-ый. Из месяцев 1 (№ п.п. 7, 19 и 31) выбираем наименьший расход ГЭС - 47 м³/с. Находим дефицит расхода $80-47=33$ м³/с. Дефицит объема $33\cdot2,63=86,79\approx86,8$ млн.м³. На это значение уменьшаем диспетчерский остаток в 1-ом месяце и получаем: 

|   Месяц    |  1  | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11|  12 |
|------------|-----|---|---|---|---|---|---|---|---|---|---|-----|
|Дисп.остаток|123,4|110| 10| 0 |710|710|710|710|610|510|410|278,4|

![image](https://github.com/user-attachments/assets/a56e9007-e925-4431-9bee-bd044b66b49a)

Остались месяцы 8-9, 20, 32-33.

Следующий, после исправленного 1-го - 2-ой. Из месяцев 2 (№ п.п. 8, 20 и 32) выбираем наименьший расход ГЭС - 25,1 м³/с. Находим дефицит расхода $80-25,1=54,9$ м³/с. Дефицит объема $54,9\cdot2,63=144,387\approx144,4$ млн.м³. Это больше, чем диспетчерский остаток во 2-ом месяце. Необходимо перераспределить избыточный объем с предыдущих месяцев так, чтобы ко 2-му месяцу оставалось больше воды.
